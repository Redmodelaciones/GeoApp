function _xRDB(id,SN){var I=this;I.CLS="¬¬#SID#¬¬";I.id="¬¬#XID#¬¬";I.id=id;I.SN=SN;I.cmd=function(m,c,fn){try{c='XRT-SCRIPT?'+m+'&'+I.CLS+'&'+I.id+'&'+escape(c)+'&'+new Date().getTime();getXML(c,fn,function(v,e){try{v='|sXML|'+(v?v.readyState:e);fn(v);}catch(e){alert(e.message)}})}catch(e){alert(e.message)}};I.GetError=function(fn){};I.RunSQL=function(sql,fn){sql=sql.replace(/%/g,'%25'); I.cmd('RUN',sql,function(d){if(fn)fn(propOK(d),propData(d))});};I.EstaConectado=function(){};I.LectorSQL=function(sql,fn){sql=sql.replace(/%/g,'%25'); I.cmd('READ',sql,function(d){  try{if(fn){fn(new DataTable(d));}}catch(e){}; });};I.Random=function(sql,fn){sql=sql.replace(/%/g,'%25'); I.cmd('RANDOM',sql,function(d){try{if(fn){d=new DataTable(d);if(d.Rows[0]){fn(d.Rows[0]);}else{fn(new DataRow(d,''));};}}catch(e){}});};I.PrimerValor=function(sql,Def){};I.CerrarConexion=function(){};I.ObtenerCadena=function(){};I.getTables=function(){};I.getViews=function(){};I.Existe=function(ix){};I.getDriverInfo=function(){};I.Protocolo=function(){return I.CP;};I.Array=function(sql,fn,df){sql=sql.replace(/%/g,'%25'); I.cmd('ARRAY',sql,function(d){try{if(fn){if(d){d=d.split('<|>');var c=d[0].split('<!>');var p;var x=new Array;for(i=1;i<d.length;i++){p=d[i].split('<!>');for(j=0;j<c.length;j++){x[c[j]]=p[j];}fn(x,i-1,d.length-1)}}else{fn(df,0,0)}}}catch(e){}});};I.AddList=function(o,sql,fn,fna){sql=sql.replace(/%/g,'%25'); I.cmd('LIST',sql,function(d){d=d.split('<|>');var MC=0;var C=d.length;if(!d[0]){C=0}if(fna){fna(C)}  if(o){var P=o.options.length;var A;for(i=0;i<C;i++){A=d[i].split('<!>');o.options[P]=new Option(A[2],A[1]);if(fn){MC=1;fn(C,A,i==C-1)};P++;}  }if(fn&&!MC){fn(0,null,true)}});};}function DataTable(r){var I=this;I.Err='';I.Rows=new Array;I.RowCount=0;I.ColumCount=0;I.Columns=new Array;I.PS=-1;I.Fila=0;I.AddRow=function(AR){I.Rows[I.Rows.length]=new DataRow(I,AR);I.RowCount++;};I.AddColumn=function(n,t,h){var CL=new DataColumn(I,n,t,h)};I.SearchColumnIndex=function(i){try{if(parseInt(i).toString()==i){return I.Columns[parseInt(i)].Index;}}catch(e){}for(var n in I.Columns){if(I.Columns[n].Name==i){return I.Columns[n].Index;}}return -1;};/*EasyManaged*/I.ResetCounter=function(){I.Fila=I.Rows[0];I.PS=-1;};I.NextRow=function(){if(I.Fila==0){I.Fila=I.Rows[0];}I.PS++;if(I.PS<0){I.PS=0;}if(I.PS<I.RowCount){try{I.Fila=I.Rows[I.PS];if(I.Fila){return true}}catch(e){alert(e.description?e.description:e);}}else{I.ResetCounter();}I.Fila=I.Rows[0];return false;};I.Index=function(){if(I.PS<1){return 0}else{return I.PS}};I.Cell=function(i){try{if(I.Fila){return I.Fila.Item(i);}}catch(e){}return '';};/*Constructor*/try{r=r.split('<3>');var LI=false;var PR=false; if(r[1]){  if(r.length>=2){/*Desifra Columnas*/PR=r[1].split('<2>');   if(PR[0]){for(i=0;i<PR.length;i++){LI=PR[i].split('<1>');I.AddColumn(LI[0],LI[1],LI[2]);}}}   /*Desifra Filas*/   if(r[2]){PR=r[2].split('<2>');for(i=0;i<PR.length;i++){I.AddRow(PR[i].split('<1>'));}}I.Fila=I.Rows[0]; }else{/*no hay contenido*/I.Err=r[0];}LI=null;PR=null;}catch(e){alert(e.description?e.description:e)}}function DataRow(TB,AR){var I=this;if(AR){I.DataTable=TB;/*Uncodec Array*/for(var n in AR){AR[n]=UnCode(AR[n]);}}else{I.DataTable=0;/*UncompressRaw*/AR=TB.replace(/&/g,'%').split('<RT-1>');for(var n in AR){AR[n]=unescape(AR[n]);}}I.ItemArray=AR;I.Item=function(i){if(I.DataTable){return I.ItemArray[I.DataTable.SearchColumnIndex(i)];}else{return I.ItemArray[i];}};I.toRaw=function(){/*Convierte RAW*/var DT='';for(var n in I.ItemArray){try{DT=DT+(DT==''?'':'<RT-1>')+escape(I.ItemArray[n]).replace(/%/g,'&');}catch(e){DT=DT+(DT==''?'':'<RT-1>');}}return DT;};}function UnCode(TX){try{if(TX.substr(0,1)=='>'){return TX.replace(/<>/g,'<');}}catch(e){alert(e.description?e.description:e)}return TX;}function DataColumn(TB,n,t,h){var I=this;if(h==null)h=n;if(t==null)t='System.String';I.DataTable=TB;I.Name=n;I.Caption=h;I.DataType=t;I.Index=TB.Columns.length;TB.Columns[I.Index]=I;TB.ColumCount++;}