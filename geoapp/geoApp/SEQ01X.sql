select a.*, GROUP_CONCAT(DISTINCT b.SOCID ORDER BY b.SOCID SEPARATOR '|') as xid, CONCAT('|',GROUP_CONCAT(DISTINCT c.PREID ORDER BY c.PREID SEPARATOR '|'),'|') as xtag from admstr01 a LEFT OUTER JOIN admsvc08 x ON a.STRID=x.STRID LEFT OUTER JOIN admsvc05 b ON x.PRDPRESOCID=b.PRDPRESOCID LEFT OUTER JOIN admsvc03 c ON b.PRDPREID=c.PRDPREID