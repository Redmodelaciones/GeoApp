function CastDateString(v,d){if(v&&v.toUpperCase&&v.toUpperCase()=='NOW'){v=new Date();}if(v&&v.getFullYear){v=v.getFullYear()+'-'+(v.getMonth()+1)+'-'+v.getDate();}if(v!=null&&v.indexOf('-')>0){v=v.split(' ')[0].split('-');if(v.length==3){if(v[0].length==4){v=('0'+v[2]).slice(-2)+'/'+('0'+v[1]).slice(-2)+'/'+v[0];}else{v=('0'+v[1]).slice(-2)+'/'+('0'+v[0]).slice(-2)+'/'+v[2];}}else{v=null;}}return v||d;};function ApplyZeroBorder(o,b){if(o&&o.style==null){o=OB(o);}if(o&&o.style){o.style.margin='0px';o.style.padding='0px';o.style.borderWidth=(b?b:'0')+'px';}};function ReadClipBoardText(fn,fne,at){try{if(!at&&navigator&&navigator.clipboard){eval("navigator.clipboard.readText().then(texto => {if(fn){fn(texto);}}).catch(error => {if(fne){fne(error);}});");return 1;}}catch(e){}if(at==null){if(fne){fne('No se Tiene Acceso al ClipBoard');}}else if(fn){fn(at);}};function GetMatrixClipBoard(fn,at){var a=new Array;if(!at){st='';}ReadClipBoardText(function(t){t=t.split('\n');var rw=0;for(var p in t){a[rw]=t[p].split('	');rw++;}if(fn){fn(a,'');}},function(e){a[0]=[''];if(fn){fn(a,e);}},at);};function _xFRM_Spinner(sid,max,min,inc,thm){var I=this;I.CLS="¬¬#SID#¬¬";I.id="¬¬#XID#¬¬";I.sid=sid;I.max=max;I.min=min;I.inc=inc;I.thm=thm;I.cmd=function(m,c,fn){try{c='XRT-SCRIPT?'+m+'&'+I.CLS+'&'+I.id+'&'+escape(c)+'&'+new Date().getTime();getXML(c,fn,function(v,e){try{v='|sXML|'+(v?v.readyState:e);fn(v);}catch(e){alert(e.message)}})}catch(e){alert(e.message)}};I.CPK=OB('_Co'+I.sid);I.APK=OB('_Ap'+I.sid);I.BTU=OB('_AU'+I.sid);I.BTD=OB('_AD'+I.sid);I.xMP=0;I.xMA=0;I.in2=0;I.ry=1845;I.rm=0;I.rd=1;I._ed=1;I._ro=0;I._ecg=new Array;/*Events*/I.onchange;I.onvalue;I.oninblur;I.oninfocus;I.onkeyenter;I.onpaste;I.CtrKey=0;I.vr=(I.thm=='#.00'?100:1);I.ecvl=function(fc,vl){if(vl==null){vl=I.APK.value;}if(I._afCVL==vl){return 0;}I._afCVL=vl;if(I.onvalue){I.onvalue(I,vl,fc);}};I.echg=function(vl){if(vl==null){vl=I.APK.value;}if(I._afSVL==vl){return 0;}I._afSVL=vl;if(I.onchange){I.onchange(I,vl);}for(var u=0;u<I._ecg.length;u++){if(I._ecg[u]){I._ecg[u](vl,I);}}};I.Enabled=function(e){if(e!=null){if(e){I.CPK.removeAttribute('disabled');}else{I.CPK.setAttribute('disabled','disabled');}I.APK.disabled=!e;I.BTU.disabled=!e||I.APK.readOnly;I.BTD.disabled=!e||I.APK.readOnly;}return !I.APK.disabled;};I.Editable=function(v){if(v!=null){I._ed=v;I.APK.readonly=!v||I._ro;}return I._ed;};I.ReadOnly=function(v){if(v!=null){I._ro=v;I.APK.readOnly=v||!I._ed;I.BTU.disabled=v||I.APK.disabled;I.BTD.disabled=v||I.APK.disabled;}return I._ro;};I.Theme=function(v){if(v!=null){I.thm=v;var vl=I._gtv();if(I.thm=='hh:mm'){if(vl>1439){vl=vl-1440;I.ecvl();}}I.APK.value=I._gts(vl);I.ecvl();}return I.thm;};I.Maximun=function(v){if(v!=null){I.max=v;var vl=I._gtv();if(I.thm=='hh:mm'){if(vl>1439){vl=vl-1440;I.ecvl();}}if(I.max!==''&&vl>I.max*I.vr){vl=I.max*I.vr;}I.APK.value=I._gts(vl);I.ecvl();}return I.max;};I.Minimun=function(v){if(v!=null){I.min=v;var vl=I._gtv();if(I.thm=='hh:mm'){if(vl<0){vl=1440+vl;I.ecvl();}}if(I.min!==''&&vl<I.min*I.vr){vl=I.min*I.vr;}I.APK.value=I._gts(vl);I.ecvl();}return I.min;};I.RefDate=function(y,m,d){I.ry=y*1;if(m<13&&m>0){I.rm=m*1-1;}if(d<32&&d>0){I.rd=d*1;}};I._FDY=function(n){if(n<10){return '0'+(n*1);}else{return n;}};I.ValDate=function(v){if(v==null){v=I.GetDate();}return v.getDate()+'/'+(v.getMonth()+1)+'/'+v.getFullYear()+' '+I._FDY(v.getHours())+':'+I._FDY(v.getMinutes())+':'+I._FDY(v.getSeconds());};I.getPos=_xFRX_GetPos;I.setPos=_xFRX_SetPos;I.Value=function(v,ft,lke,fc){if(ft||v!=null&&v!=I.APK.value){var vl=I._gtv(v);if(I.max!==''&&vl>I.max*I.vr){vl=I.max*I.vr;}if(I.thm=='hh:mm'){if(vl>1439){vl=vl-1440;}}if(I.min!==''&&vl<I.min*I.vr){vl=I.min*I.vr;}if(I.thm=='hh:mm'){if(vl<0){vl=1440+vl;}}/*UpdVal*/vl=I._gts(vl);if((!fc||!lke)&&I.APK.value!=vl){I.APK.value=vl;}I.ecvl(fc,vl);if(!lke){I.echg(vl);}return vl;}return I._gts(I._gtv());};I.GetDate=function(){var v=I._gtv();var h=0;var m=0;var s=0;if(I.thm=='hh:mm'){h=Math.floor(v/60);m=v-(h*60);}else{h=v;}return new Date(I.ry,I.rm,I.rd,h,m,s);};I._gtv=function(vl){if(vl==null){vl=I.APK.value;}if(I.thm=='hh:mm'){vl=(vl+':0').split(':');vl=vl[1]*1+vl[0]*60;}else if(I.thm=='#.00'){vl=(vl+'.').split('.');vl=vl[0]+(vl[1]+'00').substr(0,2);}return Val(vl);};I._gts=function(v){if(v==null){v=I._gtv();}if(I.thm=='hh:mm'){var h=Math.floor(v/60),m=v-(h*60);v=(h<=9?'0':'')+h+':'+(m<=9?'0':'')+m;}else if(I.thm=='#.00'){v=((v/100).toString()+'.00').split('.');if(v[1].length<2){v[1]=v[1]+'0';}if(v[1].length<2){v[1]=v[1]+'0';}v=v[0]+'.'+v[1];}return v;};I.Up=function(){var vl=I._gtv()+(I.inc*I.vr)+I.in2;if(I.max!==''&&vl>I.max*I.vr){vl=I.max*I.vr;}if(I.thm=='hh:mm'){if(vl>1439){vl=vl-1440;}}I.APK.value=I._gts(vl);I.ecvl();};I.Down=function(){var vl=I._gtv()-(I.inc*I.vr)-I.in2;if(I.min!==''&&vl<I.min){vl=I.min;}if(I.thm=='hh:mm'){if(vl<0){vl=1440+vl;}}I.APK.value=I._gts(vl);I.ecvl();};I.prgC=function(f,d){var tv=I._gtv();I.Value(I._gts(tv),1,1);if((I.min==''&&I.max=='')||(d==1&&I.min!=''&&tv<I.min*I.vr)||(d==2&&I.max!=''&&tv>I.max*I.vr)){I._afSVL=I.APK.value;}I.libC();I.xMP=setTimeout(function(){I.xMA=setInterval(f,80);},1000);};I.libC=function(){var pi=I.APK.value.length,pl=0;if(I.thm=='hh:mm'){pl=2;if(I.in2!=0){pi=0;}else{pi=pi-2;}}I.setPos(pi,pl);try{if(I.xMA){clearInterval(I.xMA);I.xMA=0;}if(I.xMP){clearTimeout(I.xMP);I.xMP=0;}}catch(e){}I.ecvl();};I.Attach=function(fn){I._ecg[I._ecg.length]=fn;};I.ShowButtons=function(v){var o=Parent(I.BTU);o.style.display=(v||v==null?'':'none');Parent(I.BTD).style.display=(v||v==null?'':'none');return o.style.display!='none';};I.Active=function(){I.APK.focus();I.APK.select();};/*UP*/AddEvent(I.BTU,'click',function(){I.Up();I.libC();I.echg();});/*DW*/AddEvent(I.BTD,'click',function(){I.Down();I.libC();I.echg();});AddEvent(I.BTU,'mousedown',function(){I.prgC(I.Up,1);});AddEvent(I.BTD,'mousedown',function(){I.prgC(I.Down,2);});I.APK.Selection=I.Selection;/*Sty*/ApplyZeroBorder(Parent(I.BTU));ApplyZeroBorder(Parent(I.BTD));AddEvent(I.APK,'click',function(){if(I.thm=='hh:mm'){if(I.getPos()<=2){I.in2=60-I.inc;}else{I.in2=0;}}else{I.in2=0;}});AddEvent(I.APK,'focus',function(o,e){if(I.oninfocus){I.oninfocus(o,e,I);}});try{I.thm=I.thm.toLowerCase();if(I.max!==''){I.max=I.max*1;}}catch(e){I.max='';}try{if(I.min!==''){I.min=I.min*1;}}catch(e){I.min='';}try{I.inc=I.inc*1;}catch(e){I.inc=1;}if(I.inc<=0){I.inc=1;}AddKeys(I.APK,function(k,o,e){/*Loket-Keys*/if(k==17){I.CtrKey=1;}else if(k==86&&I.CtrKey){e.preventDefault();GetMatrixClipBoard(function(a,e){if(!e){if(I.onpaste){I.onpaste(I,a);}}},'');I.CtrKey=0;return false;}else if((k>=48&&k<=57)||(k>=96&&k<=105)||k==13||k==9||(I.thm=='#.00'&&(k==190||k==110))){return true;}else if((I.thm==''||I.thm=='#.00')&&((k==109&&(I.min==''||I.min<0))||k==46||k==8)){return true;}e.preventDefault();return false;});AddKeys(I.APK,function(k){var tv=I._gtv(),v=I.APK.value;if(k==17){I.CtrKey=0;}else if(k==13||((I.thm==''||I.thm=='#.00')&&v!=''&&v!='-'&&v!='.'&&(I.min==''&&I.max==''?1:(I.max==''?tv>=I.min*I.vr:(I.min==''?tv<=I.max*I.vr:tv>=I.min*I.vr&&tv<=I.max*I.vr))))||(I.thm!=''&&I.thm!='#.00')){I.Value(I._gts(tv),1,k!=13,1);}if(k==13&&I.onkeyenter){I.onkeyenter(I);}},1);AddEvent(I.APK,'blur',function(o,e){I.Value(I._gts(),1,0);if(I.oninblur){I.oninblur(o,e,I);}});I.APK.value=I._gts();I._afSVL=I.APK.value;I._afCVL=I.APK.value;}function _xFRM_DatePicker(sid,max,min,sis,tip,abs){var I=this;I.CLS="¬¬#SID#¬¬";I.id="¬¬#XID#¬¬";I.sid=sid;I.max=max;I.min=min;I.sis=sis;I.tip=tip;I.abs=abs;I.cmd=function(m,c,fn){try{c='XRT-SCRIPT?'+m+'&'+I.CLS+'&'+I.id+'&'+escape(c)+'&'+new Date().getTime();getXML(c,fn,function(v,e){try{v='|sXML|'+(v?v.readyState:e);fn(v);}catch(e){alert(e.message)}})}catch(e){alert(e.message)}};I.APK=OB('_Ap'+I.sid);I.CPK=OB('_Co'+I.sid);I.APT=OB('_At'+I.sid);I.APS=OB('_As'+I.sid);I.POS=OB('_Px'+I.sid);I.xin=0;I.Meses=['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];I.MD=0;I.AddPX=0;I.AddPY=0;if(!I.APT){I.APT=I.APK;}if(I.APS&&I.tip==2){var xAPS=I.APS.value.split('|');I.APT.value=xAPS[4]||xAPS[2]||xAPS[0];}I.Ahora=function(){return new Date();};I.Dia=0;I.Mes=0;I.Ano=0;I.SD=0;I.SM=0;I.SY=0;I._slD=0;I._slM=0;I._slT=0;I._prH=0;I.ASp=0;I.ASf=0;I._ecg=new Array;/*Events*/I.onchange=0;I.onkeyacept;I.onshow;I.Enabled=function(e){if(e!=null){I.APK.disabled=!e}return !I.APK.disabled;};I.Maximun=function(v){if(v!=null){I.max=v;if(I.GetDate().getTime()>I.max.getTime()){I.APT.value=I.max.getDate()+'/'+(I.max.getMonth()+1)+'/'+I.max.getFullYear();I._CgD();}I._GHR();}return I.max;};I.Minimun=function(v){if(v!=null){I.min=v;if(I.GetDate().getTime()<I.min.getTime()){I.APT.value=I.min.getDate()+'/'+(I.min.getMonth()+1)+'/'+I.min.getFullYear();I._CgD();}I._GHR();}return I.min;};/*NxtDay*/I._DyI=0;I._NxD=function(){I._DyI++;if(I._DyI>7){I._DyI=1;};return I._DyI;};I._XPx=function(){return GetAbsLeft(I.POS)+I.AddPX;};I._XPy=function(){return GetAbsTop(I.POS)+I.AddPY;};I._XHg=function(){return GetAbsHeight(I.APK);};I._XWd=function(){return GetAbsWidth(I.APK);};I._XCl=function(){I.PIK.px=I._XPx();I.PIK.py=I._XPy()+(OverFlow(I.POS,I.PIK,0,I._XHg()).OVY?-160-I._XHg():0);var ST=I.PIK.style;if(!I.PIK.PMx){ST.left=I.PIK.px+'px';ST.top=I.PIK.py+'px';}};I.Show=function(){I._XCl();var ST=I.PIK.style;ST.zoom='1';ST.opacity='1';ST.visibility='visible';if(I.onshow){I.onshow(I);}};I.Hide=function(){var ST=I.PIK.style;ST.zoom='1';ST.opacity='0';ST.visibility='hidden';};I.PanScroll=function(os){I.POS.style.position=(os?'relative':'absolute');I._XCl();AddEvent(os,'scroll',function(o,e){I._XCl();});};I._FeM=function(m,y){return new Date(y||new Date().getFullYear(),m,0);};I._FaM=function(m,y){m--;if(m<1){m=12;y--;}return I._FeM(m,y);};I._FdM=function(m,y){m++;if(m>12){m=1;y++;}return I._FeM(m,y);};I._FDY=function(n){if(n<10){return '0'+(n*1);}else{return n;}};I.FormatDMY=function(d){if(!d){d=I.GetDate();}return I._FDY(d.getDate())+'/'+I._FDY(d.getMonth()+1)+'/'+d.getFullYear();};I._scD=function(o,ro){if(I._slD){I._slD.style.background='';};o.style.background='#FF0000';I._slD=o;if(ro&&I.PIK._Pt_md){I._scT(I.PIK._Pt_md);I.PIK._Pt_md.innerHTML=I._FDY(ro.innerHTML);}};I._scM=function(o,ro){if(I._slM){I._slM.style.background='';};o.style.background='#FF0000';I._slM=o;if(ro&&I.PIK._Pt_mm){I._scT(I.PIK._Pt_mm);I.PIK._Pt_mm.innerHTML=I._FDY(ro.msix+1);}};I._scT=function(o){if(I._slT){I._slT.style.color='';};o.style.color='#FFFF00';I._slT=o;};I._CgD=function(o){if(I.APK.value||o){I._acc(o);}var o=I.APT,f=(o.value+'/'+(I.Ahora().getMonth()+1)+'/'+I.Ahora().getFullYear()).split('/');if(!(f[0]>0&&f[0]<32)){f[0]=I.Ahora().getDate();}if(!(f[1]>0&&f[1]<13)){f[1]=I.Ahora().getMonth()+1;}if(!(f[2]>0)){f[2]=I.Ahora().getFullYear();}I.Dia=f[0];I.Mes=f[1];I.Ano=f[2];f=I._FDY(f[0])+'/'+I._FDY(f[1])+'/'+f[2];if(f!=o.value){o.value=f;}I._Rfs();I._GHR();};I._CDY=function(){var dsc=this.innerHTML;var tp=this.Tipo;switch(tp){case 1:I.After(9);break;case 2:I.Next(9);break;default:I._scD(this);}I.APT.value=I._FDY(dsc)+'/'+I._FDY(I.Mes)+'/'+I.Ano;if(tp>0||tp==null){I._GHR();}I.APK.focus();I._Rfs();};I._GD=function(CN,tx,e,tp,d,cs){var o=CreateOB('DIV','',(cs==null?'day day':cs)+(d!=null?d:'BT')+(e||e==null?' enableDay'+(tp?' otherMonth':''):' disableDay'),tx,CN);o.Tipo=tp;return o;};I._HB=function(tx,e,d){return '<button type="button" id="_pBD'+I.sid+'_'+tx+'" class="button button'+(d!=null?d:'BT')+(e||e==null?' enableBT':' disableBT')+'">'+tx+'</button>';};I._XD=function(o,d,n,no){if(no==null){no=0;}/*dia-habil*/var da=new Date(I.Ano,I.Mes-1,n).getTime();da=!(I._FeM(I.Mes,I.Ano).getTime()>=I.max.getTime()&&no==2)&&!(I._FaM(I.Mes,I.Ano).getTime()<=I.min.getTime()&&no==1)&&!(da>I.max.getTime()&&no==0)&&!(da<I.min.getTime()&&no==0);/*dia-grap*/o=I._GD(o,n.toString(),da,no,d);if(no==0&&I._FDY(n)+'/'+I._FDY(I.Mes)+'/'+I.Ano==I.APT.value){I._scD(o);};if(no==0&&I.Ano==I.SY&&I.Mes==I.SM&&I.SD==n){o.style.border='1px solid #FF0000';o.style.padding='0px';};if(da){AddEvent(o,'click',I._CDY);}};I.Next=function(e){I.Mes++;if(I.Mes>12){I.Mes=1;I.Ano++;}if(e!=9){I._GHR();}};I.After=function(e){I.Mes--;if(I.Mes<1){I.Mes=12;I.Ano--;}if(e!=9){I._GHR();}};I._GHt=function(o,m,y){var t='DIV';var FEM=I._FeM(m,y),FAM=I._FaM(m,y),SEM=1,DAY=0,DaM=0,XWe=1;I._DyI=0;var XDa=CreateOB(t,'','days','',o),XTL=CreateOB(t,'','titles','',XDa);CreateOB(t,'','title day day1','Lu',XTL);CreateOB(t,'','title day day2','Ma',XTL);CreateOB(t,'','title day day3','Mi',XTL);CreateOB(t,'','title day day4','Ju',XTL);CreateOB(t,'','title day day5','Vi',XTL);CreateOB(t,'','title day day6','Sa',XTL);CreateOB(t,'','title day day7','Do',XTL);/*Dias antes del mes*/XWe=CreateOB(t,'','week week1','',XDa);for(var ds=FAM.getDate()-(FAM.getDay()-1);ds<=FAM.getDate();ds++){DaM++;DAY=I._NxD();I._XD(XWe,DAY,ds,1);}/*Primera Semana*/var DY=0;for(var ds=1;ds+DaM<=7;ds++){DY++;DAY=I._NxD();I._XD(XWe,DAY,ds);}/*Demas Semanas*/for(var SMC=0;DY<FEM.getDate()-7;SMC++){SEM++;XWe=CreateOB(t,'','week week'+SEM,'',XDa);for(var ds=0;ds<7;ds++){DY++;DAY=I._NxD();I._XD(XWe,DAY,DY);}}/*Ultima Semana*/SEM++;XWe=CreateOB(t,'','week week'+SEM,'',XDa);for(var ds=DY;ds<FEM.getDate();ds++){DY++;DAY=I._NxD();I._XD(XWe,DAY,DY);}DY=0;for(var ds=1;DAY<7;ds++){DY++;DAY=I._NxD();I._XD(XWe,DAY,ds,2);}/*Semana Faltante*/if(SEM<6){SEM++;XWe=CreateOB(t,'','week week'+SEM+' otherMonth','',XDa);DAY=0;for(var ds=DY+1;DAY<7;ds++){DAY=I._NxD();I._XD(XWe,DAY,ds,2);}}};I._GHR_onms=function(o,e){I._scM(o,o);I._scT(I.PIK._Pt_my);I.scMS.style.display='none';I.scYR.style.display='';I.PIK._Pt_my.innerHTML=I.PIK.FD[2];I.PIK._Pt_mt.innerHTML='Año';return false;};I._GHR_psdg=function(o,e){var d=o.id.split('_');d=d[d.length-1];var tx=I.PIK._Pt_mx.innerHTML;if(d=='C'){tx='0000';}else if(d=='OK'){I.Value(new Date(parseInt(tx),I._slM.msix,I._slD.dy));I._prH=0;I.Hide();I._GHR();return false;}else{tx='0000'+tx;tx=tx.substr(tx.length-3)+d;}I.PIK._Pt_mx.innerHTML=tx;};I._GHR=function(){I.SD=I.Ahora().getDate();I.SM=I.Ahora().getMonth()+1;I.SY=I.Ahora().getFullYear();I.PIK.innerHTML='';var t='DIV';if(I.MD==1){I.PIK.className='_FRM_DatePicker1';var o,FD=I.APK.value.split('/'),ST=I.PIK.style,WS=getWinSize(),PMx=WS.Width<=400||WS.Height<=400;I.PIK.PMx=PMx;ST.position=PMx?'fixed':'absolute';ST.borderWidth=PMx?'0':'2';ST.fontSize=PMx?'18px':'10px';ST.left=(PMx?'0':I.PIK.px)+'px';ST.top=(PMx?'0':I.PIK.py)+'px';ST.width=PMx?'100%':'172px';ST.height=PMx?'100%':'135px';ST.padding=PMx?'0px':'5px';I.PIK.FD=FD;var HR=CreateOB(t,'','header','',I.PIK);if(PMx){HR.style.height='30px';HR.style.paddingTop='5px';}var TI=CreateOB(t,'','title','<span class="titleText"><span id="_Pt_md'+I.sid+'">__</span>/<span id="_Pt_mm'+I.sid+'">__</span>/<span id="_Pt_my'+I.sid+'">____</span>, <span id="_Pt_mt'+I.sid+'">Dia</span>:</span>',HR);I.PIK._Pt_md=OB('_Pt_md'+I.sid);I.PIK._Pt_mm=OB('_Pt_mm'+I.sid);I.PIK._Pt_my=OB('_Pt_my'+I.sid);I.PIK._Pt_mt=OB('_Pt_mt'+I.sid);I.PIK._Pt_md.innerHTML=FD[0];var PV=CreateOB(t,'','previous'+(PMx?'BG':''),'«',HR);I.scPV=PV;AddEvent(PV,'click',function(o,e){if(I.scMS.style.display!='none'){I._scT(I.PIK._Pt_md);I.scMS.style.display='none';I.scPV.style.display='none';I.scDY.style.display='';I.PIK._Pt_mm.innerHTML='__';I.PIK._Pt_mt.innerHTML='Dia';}else if(I.scYR.style.display!='none'){I._scT(I.PIK._Pt_mm);I.scYR.style.display='none';I.scMS.style.display='';I.PIK._Pt_my.innerHTML='____';I.PIK._Pt_mt.innerHTML='Mes';}});var CL=CreateOB(t,'','closeButton'+(PMx?'BG':''),'x',HR);AddEvent(CL,'click',function(){I._prH=0;I.Hide();I._GHR();});var BD=CreateOB(t,'','body','',I.PIK),DY=CreateOB(t,'','days'+(PMx?'BG':''),'',BD);I.scDY=DY;for(var d=1;d<=31;d++){o=I._GD(DY,d.toString());o.dy=d;if(FD[0]==d){I._scD(o);}o.I=I;AddEvent(o,'click',function(o,e){I._scD(o,o);I.scDY.style.display='none';I.scMS.style.display='';I.scPV.style.display='';I.PIK._Pt_mt.innerHTML='Mes';I._scM(I._slM,I._slM);});}var MS=CreateOB(t,'','months'+(PMx?'BG':''),'',BD),TB=CreateOB('table','','','',MS),r,c;TB.setAttribute('border','0');TB.setAttribute('cellpadding','0');TB.setAttribute('cellspacing',(PMx?'5':'3'));TB.setAttribute('width','100%');I.scMS=MS;for(var m=0;m<12;m++){if(m%2==0){r=TB.insertRow();}c=r.insertCell();c.setAttribute('width','50%');o=I._GD(c,I.Meses[m],null,null,null,'month month');o.msix=m;if(FD[1]==m+1){I._scM(o);}AddEvent(o,'click',I._GHR_onms);}var YR=CreateOB(t,'','years'+(PMx?'BG':''),'',BD);I.scYR=YR;YR.innerHTML='<table border="0" cellpadding="0" cellspacing="5" width="100%"><tr><td id="_Pt_mx'+I.sid+'" colspan="3" style="text-align:center;">'+FD[2]+'</td></tr><tr><td width="33%">'+I._HB(7)+'</td><td width="33%">'+I._HB(8)+'</td><td width="33%">'+I._HB(9)+'</td></tr><tr><td>'+I._HB(4)+'</td><td>'+I._HB(5)+'</td><td>'+I._HB(6)+'</td></tr><tr><td>'+I._HB(1)+'</td><td>'+I._HB(2)+'</td><td>'+I._HB(3)+'</td></tr><tr><td>'+I._HB(0)+'</td><td>'+I._HB('C')+'</td><td>'+I._HB('OK')+'</td></tr></table>';I.PIK._Pt_mx=OB('_Pt_mx'+I.sid);TB=YR.getElementsByTagName('button');for(r=0;r<TB.length;r++){c=TB[r];if(c.id.indexOf('_pBD')==0){AddEvent(c,'click',I._GHR_psdg);}}I._scT(I.PIK._Pt_md);I.scPV.style.display='none';I.scDY.style.display='';I.scMS.style.display='none';I.scYR.style.display='none';}else{I.PIK.className='_FRM_DatePicker';var HR=CreateOB(t,'','header','',I.PIK);var TI=CreateOB(t,'','title','<span class="titleText">'+I._GHM()+' - '+"<div id='_Co_S!/XID/' class=\"_FRM_Spinner \" style=\"padding:0px;margin-top:0px;margin-bottom:-2px;display:inline-block;\"><table width='20' height='20' border='0' cellpadding='0' cellspacing='0' bgcolor='#FFFFFF' style=\"width:40px;padding:0px;margin:0px; height:12px;border:0px solid #FFFFFF;background-color:transparent;\"><tr><td rowspan='2' style='padding-right:3px;'><input type='text' name='_S!/XID/' id='_Ap_S!/XID/' class='__x_NUM' value='/XVL/' autocomplete=\"off\"/></td><td width='3' align='right'><input type='button' id='_AU_S!/XID/' value=' ' class='__x_BTUP' style=\"height:6px;background-color:transparent;\"/></td></tr><tr><td width='3' align='right'><input type='button' id='_AD_S!/XID/' value=' ' class='__x_BTDW' style=\"height:6px;background-color:transparent;\"/></td></tr></table></div>".replace(/\/XID\//g,I.sid).replace(/\/XVL\//g,I.Ano)+'</span>',HR);var PV=CreateOB(t,'','previous','«',HR);AddEvent(PV,'click',I.After);PV.style.visibility=(I._FaM(I.Mes,I.Ano).getTime()>I.min.getTime()?'visible':'hidden');var NX=CreateOB(t,'','next','»',HR);AddEvent(NX,'click',I.Next);NX.style.visibility=(I._FeM(I.Mes,I.Ano).getTime()<I.max.getTime()?'visible':'hidden');var CL=CreateOB(t,'','closeButton','x',HR);CL.style.display='none';var BD=CreateOB(t,'','body','',I.PIK), xC1=CreateOB(t,'','','',BD);I._GHt(xC1,I.Mes,I.Ano);AddEvent(OB('_Sm'+I.sid),'change',function(o,e){I.Mes=parseInt(o.value)+1;I._GHR();});I.SPN=new _xFRM_Spinner('_S!'+I.sid,I.max.getFullYear(),I.min.getFullYear(),'1','');I.SPN.onchange=function(o,v){v=parseInt(v);if(I.Ano!=v){I.Ano=v;I._GHR();}};I.SPN.onvalue=function(o,v,fc){if(fc){I.SPN.onchange(o,v);setTimeout(function(){o=I.SPN.APK;o.focus();o.select();},100);}};AddEvent(I.SPN.APK,'mouseover',function(o,e){I.ASp=1;});AddEvent(I.SPN.APK,'mouseout',function(o,e){I.ASp=I.ASf;});I.SPN.oninfocus=function(o,e){I.ASf=1;};I.SPN.oninblur=function(o,e){I.ASf=0;if(I._prH){I.APK.focus();}else{I._acc(1);I.Hide();}};}};I._GHM=function(s){var l='<select id="_Sm'+I.sid+'" style="width:75px;">';for(var i=0;i<12;i++){l=l+'<option value="'+i+'"'+(I.Mes-1==i?' selected="selected"':'')+'>'+I.Meses[i]+'</option>';}return l+'</select>';};I.Model=function(m){if(m!=null){I.MD=m;I._GHR();}return I.MD;};I.CastValue=CastDateString;I.Value=function(d){d=CastDateString(d);/*OK*/if(d!=null&&I.APT.value!=d){I.APT.value=d;I._CgD();I._GHR();}return I.APT.value;};I.Fecha=function(){d=I.GetDate(),m=d.getMonth()+1,dy=d.getDate();return d.getFullYear()+'-'+(m<=9?'0':'')+m+'-'+(dy<=9?'0':'')+dy;};I.GetDate=function(){var f=I.APT.value.split('/');if(f[2]){return new Date(f[2],(f[1])*1-1,f[0]);}else{return new Date();}};I._cl=[7,1,2,3,4,5,6];I._cx=[2,1,7,6,5,4,3];I.GetWeek=function(d){if(!d){d=I.GetDate();}var pd=I._cl[d.getDay()],di=new Date(d.getFullYear(),d.getMonth(),d.getDate()-pd+1),dy=di.getFullYear(),dm=di.getMonth(),dd=di.getDate(),df=new Date(dy,0,I._cx[new Date(dy,0,1).getDay()]),ds=new Date(dy,dm,dd+6),sm=Math.floor((ds-df)/1000/60/60/24/7)+1;di=I.FormatDMY(di);ds=I.FormatDMY(ds);d=dy+'|'+I._FDY(sm)+'|'+di+'|'+ds+'|'+I._FDY(d.getDate())+'/'+I._FDY(d.getMonth()+1)+'/'+d.getFullYear()+'|'+pd;if(I.APS&&I.tip==2){I.APK.value='Semana '+I._FDY(sm)+' del '+di+' al '+ds;I.APS.value=d;}return d;};I.GetWeekDays=function(d){if(!d){d=I.GetDate();};var pd=I._cl[d.getDay()],dy=d.getFullYear(),dm=d.getMonth(),dd=d.getDate()-pd+1;return [new Date(dy,dm,dd),new Date(dy,dm,dd+1),new Date(dy,dm,dd+2),new Date(dy,dm,dd+3),new Date(dy,dm,dd+4),new Date(dy,dm,dd+5),new Date(dy,dm,dd+6)]};I._Rfs=function(b){var d=(I.tip==2?I.GetWeek():I.GetDate()),v=(I.tip==2?I.GetWeekDays():I.Value());if(I.LsVal!=I.APK.value){I.LsVal=I.APK.value;if(I.onchange&&!b){I.onchange(I,d,v);}for(var u=0;u<I._ecg.length;u++){if(I._ecg[u]){I._ecg[u](v,I);}}}};I.Refresh=function(b){I.LsVal='{NULL}';I._Rfs(b);};I.Attach=function(fn){I._ecg[I._ecg.length]=fn;};I._act=function(){if(I.tip==1){setTimeout(function(){var pi=0,pl=2;if(I.xin==1){pi=3;}else if(I.xin==2){pi=6;pl=4;}I.setPos(pi,pl);},50);}};I._acc=function(c,b){if(I.tip==1){var v=I.APK.value.split('/'),t=parseInt(v[1]);if(I.xin==1&&b){t='__';}else if(!t){t=1}else if(t>12){t=12;}v[1]=('00'+t).slice(-2);t=('0000'+(v[2]||'1901')).slice(-4);if(I.xin==2&&b){t='____';}else if(parseInt(t)<1901||t=='____'){t=1901;}v[2]=t;t=parseInt(v[0]);if(I.xin==0&&b){t='__';}else if(!t){t=1}else if(c){c=new Date(parseInt(v[2]),parseInt(v[1]),0).getDate();if(t>c){t=c;}}else if(t>31){t=31;}v[0]=('00'+t).slice(-2);v=v.join('/');if(v!=I.APK.value){I.APK.value=v;}}};I.getPos=_xFRX_GetPos;I.setPos=_xFRX_SetPos;I.Active=function(){I.APK.focus();I.APK.select();I.APK.click();};/*Constructor*/I.APK.readOnly=I.tip!=1||IsDroid();try{I.sis=(I.sis+'x0').split('x');I.AddPX=I.sis[0]*1;I.AddPY=I.sis[1]*1;}catch(e){}AddEvent(I.APK,'blur',function(o,e){if(I._prH){if(!I.ASp){I.APK.focus();}}else{I.Hide();I.xin=0;if(I.APK.value.indexOf('_')>=0){I._CgD(o,e);}}});AddEvent(I.APK,'focus',I.Show);AddEvent(I.APK,'dblclick',I.Show);AddEvent(I.APK,'click',function(o,e){if(I.tip==1){var p=o.value.substr(0,I.getPos()+1).split('/');I.xin=p.length-1;I._acc();I._act();}});I.PIK=CreateOB('DIV','','_FRM_DatePicker','',I.CPK);AddEvent(I.PIK,'mouseover',function(){I._prH=1;});AddEvent(I.PIK,'mouseout',function(){I._prH=0;});AddKeys(I.APK,function(k,o,e){if(I.tip!=1){return true;}if((k>=48&&k<=57)||(k>=96&&k<=105)){return true;}else if(k==37){I._acc();if(I.xin>0){I.xin=I.xin-1;}I._act();}else if(k==8||k==46){I._acc(0,1);I._act();}else if(k==39||k==111||k==13||k==9){if(o.value.indexOf('/')<0){I.xin=0;}if(I.xin==2){if(k==39||k==111||k==13){I._CgD(o,e);if(I.onkeyacept){I.onkeyacept(I,I.GetDate(),I.Value());}}if(k==9){I._prH=0;I.Hide();return true;}}else{I.xin=I.xin+1;I._acc();}I._act();}e.preventDefault();return false;});AddEvent(I.APT,'change',I._CgD);if(IsDroid()){I.MD=1;}I.APK.value=CastDateString(I.APK.value,I.APK.value);I._CgD();I.Hide();}function _xFRM_Tab(sid,pst,otb,dbr,pgr,wd){var I=this;I.CLS="¬¬#SID#¬¬";I.id="¬¬#XID#¬¬";I.sid=sid;I.pst=pst;I.otb=otb;I.dbr=dbr;I.pgr=pgr;I.wd=wd;I.cmd=function(m,c,fn){try{c='XRT-SCRIPT?'+m+'&'+I.CLS+'&'+I.id+'&'+escape(c)+'&'+new Date().getTime();getXML(c,fn,function(v,e){try{v='|sXML|'+(v?v.readyState:e);fn(v);}catch(e){alert(e.message)}})}catch(e){alert(e.message)}};I.XPS=OB('_Co'+I.sid);I.CTP=OB('_Ct'+I.sid).rows[0];I._xI=0;I._xR=0;I.SelTab;I._Pd=5;/*Eventos*/I.onadd;I.onselectedindex;I.onclear;I._HdPn=function(){var o,oP1;for(var i=0;i<I.CTP.cells.length;i++){o=I.CTP.cells[i];if(o.nix>=0&&I.otb){oP1=OB(I.otb.toString()+o.nix);if(oP1){oP1.style.display='none';}}if(o.TBP){o.TBP.style.display='none';}}};I.Add=function(nm,TBP){if(TBP&&TBP.style==null){TBP=OB(TBP);}var n=I.CTP.insertCell(),o=CreateOB('table','','','',n),r=o.insertRow(0),c;ApplyZeroBorder(n);o.o=n;n.LT=o;o.setAttribute('width','28');o.setAttribute('height','24');o.setAttribute('border','0');o.setAttribute('cellpadding','0');o.setAttribute('cellspacing','0');c=CreateOB('td','','_FRM_Tab_BRDI','<div style="width:4px;height:24px;"></div>',r);c.o=n;n.LI=c;ApplyZeroBorder(c);ApplyZeroBorder(c.firstChild);c.setAttribute('width','4');c=CreateOB('td','','_FRM_Tab_BRCN','',r);c.o=n;n.LC=c;c.setAttribute('width','100%');c.setAttribute('title',nm);c.setAttribute('align','center');c.innerHTML=nm;c=CreateOB('td','','_FRM_Tab_BRDI','<div style="width:4px;height:24px;background-position:-5px 0px;"></div>',r);c.o=n;n.LD=c;ApplyZeroBorder(c);ApplyZeroBorder(c.firstChild);c.setAttribute('width','4');n.LC.style.paddingLeft=I._Pd+'px';n.LC.style.paddingRight=I._Pd+'px';n.nix=I._xR;n._sP=I;I._xR=I._xR+1;n.TBP=TBP;n._Unselect=function(){n.LI.style.visibility='hidden';n.LD.style.visibility='hidden';n.LC.className='_FRM_Tab_BRCN';};n._Unselect();n.Select=function(o){o=o||this||n;if(I.SelTab){I.SelTab._Unselect();}I.SelTab=o;o.LI.style.visibility='visible';o.LD.style.visibility='visible';o.LC.className='_FRM_Tab_BRC';o._sP._HdPn();if(o.nix>=0&&o._sP.otb){var oP1=OB(o._sP.otb.toString()+o.nix);if(oP1){oP1.style.display='';}}if(o.TBP){o.TBP.style.display='';}if(!I._xI){alert('Debe ejecutar el codigo "'+I.sid+'.Init();", antes de utilizar.');}else if(I.onselectedindex){I.onselectedindex(o.nix,o);}return o;};AddEvent(n,'click',function(o,e){o.Select(o);return false;});if(I.onadd){I.onadd(n,nm);}if(I._xI&&n.nix==0){n.click();}return n;};I.FirstSelectTab=function(){if(I.CTP){var p=I.CTP.cells[0];if(p&&p.Select){return p.Select(p);}}return 0;};I.Width=function(v){if(v!=null){var vr=v.toString().substr(v.length-1);if(v&&vr&&vr.replace(/[0-9]/g,'##')=='##'){v=v+'px';}if(v){I.XPS.style.width=v;}}else{var w=I.XPS.style.width.toString().replace('px','').replace(';',''),pE=w.substr(w.length-1);return w&&pE&&pE.replace(/[0-9]/g,'##')=='##'?parseFloat(w):w;}};I.Width(I.wd);I.ApplyGradiant=function(ao){if(ao&&ao.style!=null){ao.className+=(ao.className?' ':'')+'_FRM_Tab_BRC';}};I.SelectedIndex=function(v){if(v!=null){var n=I.CTP.cells[parseInt(v)];if(n){n.click();}}else{if(I.SelTab){return I.SelTab.cellIndex;}return -1;}};I.Init=function(dbr){if(dbr==null){dbr=I.dbr;}I.dbr=dbr;I._xI=1;var o,oP1,sP1='1px solid #BEC0C3';if(I.SelTab){I.SelTab._Unselect();I.SelTab=0;}for(var i=0;i<I.CTP.cells.length;i++){o=I.CTP.cells[i];if(o&&o.style.display!='none'&&!I.SelTab){o.click();}if(dbr){oP1=OB(I.otb.toString()+o.nix);if(oP1){oP1.style.borderLeft=sP1;oP1.style.borderRight=sP1;oP1.style.borderBottom=sP1;}}}if(dbr){oP1=Parent(I.XPS);oP1.style.borderLeft=sP1;oP1.style.borderRight=sP1;oP1.style.borderTop=sP1;}};I.Clear=function(){I._HdPn();I.SelTab=0;while(I.CTP.cells.length>0){RemoveOB(I.CTP.cells[0]);}I._xR=0;if(I.onclear){I.onclear(I);}};I.Padding=function(v){if(v!=null){v=Val(v);I._Pd=v;var j,o;for(j=0;j<I.CTP.cells.length;j++){o=I.CTP.cells[j].LC;if(o){o.style.paddingLeft=v+'px';o.style.paddingRight=v+'px';}}}return I._Pd;};if(I.pst){var pst=I.pst.split('|');for(var i=0;i<pst.length;i++){I.Add(pst[i]);}}if(I.pgr){I.XPS.className='_FRM_Tab _FRM_TabS1';}}function _xFRM_GridView(sid){var I=this;I.CLS="¬¬#SID#¬¬";I.id="¬¬#XID#¬¬";I.sid=sid;I.cmd=function(m,c,fn){try{c='XRT-SCRIPT?'+m+'&'+I.CLS+'&'+I.id+'&'+escape(c)+'&'+new Date().getTime();getXML(c,fn,function(v,e){try{v='|sXML|'+(v?v.readyState:e);fn(v);}catch(e){alert(e.message)}})}catch(e){alert(e.message)}};}function _xFRX_GetPos(){var I=this,o=I.APK;var p=0;if(document.selection){o.focus();var s=document.selection.createRange(); s.moveStart('character',-o.value.length);p=s.text.length; }else if(o.selectionStart!=null){p=o.selectionStart;}return (p);}function _xFRX_SetPos(s,l){var I=this,o=I.APK;if(s==null||s<0){s=0;}l=s+(l||0); if(o.setSelectionRange){o.focus();o.setSelectionRange(s,l); }else if(o.createTextRange){var r=o.createTextRange();r.collapse(true);r.moveEnd('character', l);r.moveStart('character', s);r.select(); }else if(o.selectionStart!=null){o.focus();o.selectionStart=s;o.selectionEnd=l; }}